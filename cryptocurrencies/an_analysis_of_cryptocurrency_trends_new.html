<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    Cryptocurrencies such as Bitcoin, Litecoin, and many others became a very hot topic in 2017. Financial data such as stock and currency values are not usually very accurately forecastable based solely on their previous values (especially highly volatile ones, such as the cryptocurrencies being considered here - at least as of 2017), so what I primarily desire to see is the level of unpredictability in these currencies' values in recent times. I will use Monte Carlo simulations and machine learning regression models to predict these currency values for arbitrary days given a window of preceding values.
<h2>Data</h2>
I acquired the dataset from Kaggle (<a href="https://www.kaggle.com/sudalairajkumar/cryptocurrencypricehistory" target="_blank" rel="noopener">here</a>). The format is standard for financial data - containing the open, high, low, and close values, along with the volume (number of "coins" in circulation) and market capitalizations (the values of units of the currencies multiplied by their volumes) for each day. The cryptocurrencies included in this dataset are Bitcoin Cash,  Bitcoin, BitConnect, Dash, Etherium Classic, Etherium, Iota, Litecoin, Monero, Nem, Neo, Numeraire, Omisego, Qtum, Ripple, Stratis, and Waves (17 altogether). Several of these cryptocurrencies had very short histories, only dating back to the middle of 2016, so they were ignored in this analysis. The currencies that I examine are Bitcoin (BTC), Dash (DASH), Etherium (ETH), Litecoin (LTC), Monero (XMR), Nem (XEM), and Ripple (XRP). The date range examined for these cryptocurrencies is August 7, 2015 through November 7, 2017.
<h2>Article Overview</h2>
I first present an executive summary, detailing the results of the study. Afterward, I present a description of the code used to perform the analysis.

I completed this project twice - once in Python and once in R. Volatility and forecast figures  were also created in Tableau. There are two significant differences for this article. The first significant difference is in the appearance of figures, which are labeled by source (Python/R/Tableau). The second significant difference is in the predictions of future values. I only recently began learning Tableau and R - along with some relevant libraries for R - so I am not as proficient with them as I am with Python and its relevant libraries. In my opinion, the Python figures are more visually appealing, so they should be focused on.
<h1>Executive Summary</h1>
<h2>Volatility Examination</h2>
The volatility of a financial asset is the standard deviation of its returns. More specifically, volatility is calculated as the standard deviation of percent differences of closing values between days. It may be surmised that the greater the volatility of a financial asset, the greater the risk involved in investing in that asset. Below is a bar chart of the volatilities of seven of the oldest cryptocurrencies in 2017.

<strong>Python figure</strong>
<img src="http://johncrattz.com/wp-content/uploads/2018/01/volatility_cropped.png" alt="" width="2972" height="1567" class="alignnone size-full wp-image-8" /><strong>R figure</strong>
<img src="http://johncrattz.com/wp-content/uploads/2018/01/volatility-1024x646.png" alt="" width="750" height="473" class="size-large wp-image-49 alignnone" />
<strong>Tableau figure</strong>

<img src="http://johncrattz.com/wp-content/uploads/2018/01/volatility-2.png" alt="" width="875" height="415" class="alignnone size-full wp-image-103" />

Ripple (XRP) has the highest volatility, but this is primarily due to its rapid rise in value from around $0.05 to around $0.30 in May 2017, when Ripple detailed some of its plans. Nem (XEM) also has a high volatility for a similar reason to Ripple - also sharply rising in value in May 2017 - except that Nem's increase in value is largely due to Japan.
<h2>Trends and Value Correlations</h2>
The values of these currencies vary with each other to some degrees. The degree to which a variable varies with another is called a correlation coefficient, and it is a value between -1 and 1, indicating the degree of dependence between the two variables, with -1 indicating a perfectly inverse relationship, 0 indicating the absence of any relationship, and 1 indicating a perfectly direct relationship. Below is a heatmap of the correlations between the cryptocurrencies.

<strong>Python figure</strong>
<img src="http://johncrattz.com/wp-content/uploads/2018/01/correlations.png" alt="" width="985" height="980" class="alignnone size-full wp-image-9" /><strong>R figure</strong>
<img src="http://johncrattz.com/wp-content/uploads/2018/01/correlations-1-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-50" />

This is a symmetric matrix, so you can look at either of the two intersections of two cryptocurrencies for the correlation value between them, but looking at the column first and then the row is more natural in my experience. The lines to the left and top of the heatmap indicate hierarchical clusters, with lower levels of the hierarchy being increasingly correlated. So, for example, Waves, Etherium, and Nem are strongly related, but Etherium and Nem are more closely related to each other than they are to Waves. In at least this case, this can be seen fairly easily by inspecting the correlation coefficients in these columns or rows. The correlation coefficients among other cryptocurrencies to Etherium and Nem are consistently closer in value to each other than either of them are to Waves. Phrased differently, the values in the Etherium and Nem rows or columns are closer to each other than either of them are to the values in the Waves row or column.

Based on the individual cells in this figure, the following direct, one-to-one relationships between cryptocurrencies can be inferred:

Numeraire has many negative direct relationships with other cryptocurrencies. This is likely because it has had a general downward trend in value, whereas many other cryptocurrencies have had upward trends in value.

Ripple and Nem have a close direct correlation (0.94), which may primarily be due to them both having sharp rises in value in May 2017, as previously mentioned.

Etherium Classic has a close direct relationship with several other cryptocurrencies, but the most notable are Stratis (0.95), Etherium (0.94), and Waves (0.93).

Stratis has a close direct relationship with Waves (0.96) and Etherium Classic (0.95).

BitConnect has a very close direct relationship with Bitcoin (0.99, unsurprisingly), but fairly weak relationships with other cryptocurrencies.

Waves has close direct relationships with Etherium (0.97), Stratis (0.96), Nem (0.95).

Etherium, like Etherium Classic, has a close direct relationship with several other cryptocurrencies, but the most notable are Waves (0.97), Nem (0.96), Litecoin (0.96), Dash (0.95), and Etherium Classic (0.94).

Nem has close direct relationships with Etherium (0.96), Waves (0.95), Litecoin (0.95), Dash (0.94), and Ripple (0.94).

Neo does not have a close direct relationship with any other cryptocurrency, which is probably because it had a fairly consistent value until June 2017.

Bitcoin has close direct relationships with BitConnect (0.99), Dash (0.95), and Monero (0.95).

Finally, Dash and Monero are highly correlated (0.98), perhaps due to their privacy measures.

I am still learning about these cryptocurrencies, so I am unsure of the causes of the high degree of correlation between some of them, but I imagine that much of the correlation among cryptocurrencies is due to them all being cryptocurrencies (same market) and speculation across all of them to varying degrees, primarily from the latter half of 2017 onwards.
<h2>Validation</h2>
In the following series of graphs, the values of the selected cryptocurrencies are plotted both for their actual values and the values predicted by the model. The lines for the actual values are blue and the lines for the predicted values are red, so since a well-fit regression model should predict very similar values to the actual values for dates that it trained on, these lines should overlap, resulting in mostly purple lines, as is the case.

<strong>Python figures</strong>
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Bitcoin_validation_300_cropped.png" alt="" width="2038" height="1048" class="alignleft size-full wp-image-10" /><img src="http://johncrattz.com/wp-content/uploads/2018/01/Dash_validation_300_cropped.png" alt="" width="2020" height="1048" class="alignnone size-full wp-image-11" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Etherium_validation_300_cropped.png" alt="" width="2020" height="1048" class="alignnone size-full wp-image-12" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Litecoin_validation_300_cropped.png" alt="" width="2003" height="1048" class="alignnone size-full wp-image-13" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Monero_validation_300_cropped.png" alt="" width="2020" height="1048" class="alignnone size-full wp-image-14" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Nem_validation_300_cropped.png" alt="" width="2029" height="1048" class="alignnone size-full wp-image-15" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ripple_validation_300_cropped.png" alt="" width="2029" height="1048" class="alignnone size-full wp-image-16" /><strong>R figures</strong>
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Bitcoin_validation_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-51" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Dash_validation_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-52" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ethereum_validation_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-53" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Litecoin_validation_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-54" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Monero_validation_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-55" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Nem_validation_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-56" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ripple_validation_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-57" />
<h2>Forecasting</h2>
The following are value predictions (extrapolations) for the date range November 8, 2017 to December 31, 2018. Forecast characteristics and differences are explained in the section "Detailed Description - Model Training and Model Selection" below.

<strong>Python figures
</strong><img src="http://johncrattz.com/wp-content/uploads/2018/01/Bitcoin_predictions_300_cropped.png" alt="" width="1991" height="1048" class="alignnone size-full wp-image-17" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Dash_predictions_300_cropped.png" alt="" width="1973" height="1048" class="alignnone size-full wp-image-18" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Etherium_predictions_300_cropped.png" alt="" width="2000" height="1048" class="alignnone size-full wp-image-19" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Litecoin_predictions_300_cropped.png" alt="" width="2000" height="1048" class="alignnone size-full wp-image-20" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Monero_predictions_300_cropped.png" alt="" width="1956" height="1048" class="alignnone size-full wp-image-21" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Nem_predictions_300_cropped.png" alt="" width="2000" height="1048" class="alignnone size-full wp-image-22" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ripple_predictions_300_cropped.png" alt="" width="2018" height="1048" class="alignnone size-full wp-image-23" /><strong>R figures
</strong><img src="http://johncrattz.com/wp-content/uploads/2018/01/Bitcoin_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-58" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Dash_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-59" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ethereum_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-60" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Litecoin_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-61" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Monero_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-62" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Nem_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-63" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ripple_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-64" />

Finally, here are the predictions above plotted along with the actual values for the initial date range.

<strong>Python figures
</strong><img src="http://johncrattz.com/wp-content/uploads/2018/01/Bitcoin_actual_plus_predictions_300_cropped.png" alt="" width="2018" height="1048" class="size-full wp-image-24 alignnone" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Dash_actual_plus_predictions_300_cropped.png" alt="" width="2000" height="1048" class="alignnone size-full wp-image-25" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Etherium_actual_plus_predictions_300_cropped.png" alt="" width="2000" height="1048" class="alignnone size-full wp-image-26" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Litecoin_actual_plus_predictions_300_cropped.png" alt="" width="1983" height="1048" class="alignnone size-full wp-image-27" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Monero_actual_plus_predictions_300_cropped.png" alt="" width="2000" height="1048" class="alignnone size-full wp-image-28" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Nem_actual_plus_predictions_300_cropped.png" alt="" width="2009" height="1048" class="alignnone size-full wp-image-29" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ripple_actual_plus_predictions_300_cropped.png" alt="" width="2009" height="1048" class="alignnone size-full wp-image-30" /><strong>R figures
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Bitcoin_actual_plus_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-65" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Dash_actual_plus_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-66" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ethereum_actual_plus_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-67" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Litecoin_actual_plus_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-68" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Monero_actual_plus_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-69" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Nem_actual_plus_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-70" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/Ripple_actual_plus_predictions_300-1024x646.png" alt="" width="750" height="473" class="alignnone size-large wp-image-71" /></strong><strong>Tableau figures</strong>

<img src="http://johncrattz.com/wp-content/uploads/2018/01/bitcoin_actual_plus_predictions.png" alt="" width="884" height="726" class="alignnone size-full wp-image-87" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/dash_actual_plus_predictions.png" alt="" width="884" height="726" class="alignnone size-full wp-image-88" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/ethereum_actual_plus_predictions.png" alt="" width="884" height="726" class="alignnone size-full wp-image-89" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/litecoin_actual_plus_predictions.png" alt="" width="884" height="726" class="alignnone size-full wp-image-90" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/monero_actual_plus_predictions.png" alt="" width="884" height="726" class="alignnone size-full wp-image-91" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/nem_actual_plus_predictions.png" alt="" width="884" height="726" class="alignnone size-full wp-image-92" />
<img src="http://johncrattz.com/wp-content/uploads/2018/01/ripple_actual_plus_predictions.png" alt="" width="884" height="726" class="alignnone size-full wp-image-93" />
<h1>Detailed Description</h1>
<h2>Data Processing and Figure Creation</h2>
<h3>Python</h3>
The data was imported and processed with the <em>pandas </em>library. Plots were made with the <em>matplotlib </em>and <em>seaborn</em> libraries. Specifically, the cluster map of value correlations, the figure showing value histories (a heat map of cells with no values), and the bar plot of volatility were crated with <em>seaborn</em>. All other plots were created with <em>matplotlib</em>.
<h3>R</h3>
The data was imported from CSVs with builtin functions in R (<em>read.csv()</em>) and from a mySQL server running on my machine with a library called <em>RMySQL</em>. All plots were created with the <em>ggplot2</em> library.
<h3>Tableau</h3>
The data was imported in the Data Source pane through joins on the Date field. Although I managed to calculate volatility for each cryptocurrency, the values are duplicated across the days for each cryptocurrency. This can be seen by hovering the cursor over the bars in the volatility bar chart in Tableau; instead of an entire bar being highlighted, small slices are highlighted. Because of this, the volatility could not be displayed in text over the bars, and the volatility axis perceived limits incorrectly (the bars' heights are proportional to their volatility values, but the chart perceives the bars' values as much higher - probably by summing volatility across days).

The predictions were flat because there is no seasonality or trend in the data. Tableau forms trend lines by looking for seasonal patterns (e.g. high sales in December and low sales in the first quarter) and the overall trend of the data (linear/exponential increasing/decreasing), so it is not very suited for the task of predicting the value of highly volatile financial assets. In a formal report, it would likely be better to include an external figure. If the tooltip information was very important, R code should be used within Tableau.
<h2>Model Training and Model Selection</h2>
<h3>Python</h3>
The library used for machine learning was <em>scikit-learn</em> (or <em>sklearn</em>). Regression models were trained on windows of 30 to 360 days of values for the selected cryptocurrencies, using grid-search (<em>GridSearchCV)</em> and k-fold cross validation (<em>KFold</em>) to find the best model across multiple model types and parameter sets to train those models with. For each window size, an extra-trees regressor (<em>ExtraTreesRegressor</em>)<em>,</em> random forest regressor (<em>RandomForestRegressor</em>), and KNearestNeighbors regressor (<em>KNeighborsRegressor</em>) were trained. For many window sizes, the predictions were smooth and nearly monotonically increasing or decreasing lines like the following figure.

<img src="http://johncrattz.com/wp-content/uploads/2018/01/Bitcoin_predictions_330_cropped.png" alt="" width="1991" height="1048" class="alignnone size-full wp-image-31" />

The largest window size that gave more significant variations was 300 days, or approximately 10 months. Thus, I choose to show the results for a window size of 300. For a window size of 300, the model chosen was an extra-trees regressor. The seemingly asymptotic trend toward flat lines (predicted constant values for the cryptocurrencies) is likely due to the window of previous values becoming less similar to windows that the model trained on as more of the window's values become previous predicted values rather than actual values.
<h3>R</h3>
The library used for machine learning was the <em>caret</em> library. Regression models were trained on windows of 30 to 360 days of values for the selected cryptocurrencies, using grid-search (<em>caret.train</em>) to find the best model across multiple model types and parameter sets to train those models with. For each window size, an extra-trees regressor (<em>extraTrees</em>) was trained. The random forest regressor (<em>rf</em>) seemed to freeze R during training and the KNearestNeighbors regressor (<em>knn</em>) output constant values for predictions.

The R models never output nearly monotonically increasing or decreasing lines like some of the Python models, but the R code only trained extra-trees regressors. All window sizes gave significant variations for the extra-trees regressors, but I only showed the results for a window size of 300 because I did so with Python. As in Python, the seemingly asymptotic trend toward flat lines (predicted constant values for the cryptocurrencies) is likely due to the window of previous values becoming less similar to windows that the model trained on as more of the window's values become previous predicted values rather than actual values.
<h2>Source Code</h2>
The full source code can be found <a href="https://github.com/JohnRattz/data_science">here</a>, in the "cryptocurrencies" folder. More information on the code and files in that folder is in the README for that repository under the heading for the "cryptocurrencies" folder.
</body>
</html>